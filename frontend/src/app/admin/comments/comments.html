<app-header-admin></app-header-admin>
<div *ngIf="!loading && isAdmin; else noAccess">

<!-- Barra de b√∫squeda -->
<div class="flex items-center m-4 max-w-md">
  <button
    class="px-4 py-2 text-white rounded-l-full transition"
    style="background-color: #7A1CFF; border-color: #7A1CFF;"
    onmouseover="this.style.backgroundColor='#6518d8'"
    onmouseout="this.style.backgroundColor='#7A1CFF'">
    üîç
  </button>
  <input
    type="text"
    placeholder="Buscar..."
    [(ngModel)]="searchTerm"
    class="flex-1 px-4 py-2 border border-gray-300 rounded-r-full focus:outline-none" />
</div>

<!-- Contendor flexible divirlo en dos -->
<div class="flex h-screen">
  <!-- Panel izquierdo -->
  <div class="w-1/3 bg-gray-300 p-4">
    <h2 class="font-bold mb-4">Comments</h2>
    <!-- Iteraci√≥n, recorre los comentarios filtrados -->
    @for (item of filteredComments(); track $index) {
      <!-- Cada comentario es como una "tarjeta" a la que se accede uno por uno -->
      <div
        (click)="selectComment(item)"
        class="cursor-pointer bg-white shadow rounded-lg p-3 mb-3 hover:bg-gray-100 transition">

        <p class="font-semibold text-gray-900">{{ item.titulo }}</p>
        <p class="text-sm text-gray-500">{{ item.nombre }}</p>
        <p class="text-xs text-gray-400">{{ item.correo }}</p>
      </div>
    } @empty {
      <p class="text-gray-400 italic">No comments yet.</p>
    }
  </div>

  <!-- Panel derecho -->
  <div class="w-2/3 bg-gray-300 p-6 relative">
    <!-- Solo se muestra si hay un comentario seleccionado -->
    @if (selectedComment) {
      <h2 class="text-xl font-bold mb-2 text-[50px]">{{ selectedComment.titulo }}</h2>
      <p class="text-gray-600 mb-1 text-[30px]">By {{ selectedComment.nombre }}</p>
      <p class="text-gray-500 text-[30px]">{{ selectedComment.correo }}</p>
      <p class="text-gray-800 text-[40px]">{{ selectedComment.mensaje }}</p>

      <button
        *ngIf="selectedComment?.id !== undefined"
        (click)="deleteComment(selectedComment.id!)"
        class="absolute bottom-4 right-4 px-4 py-2 text-white rounded transition"
        style="background-color: #7A1CFF; border-color: #7A1CFF;"
        onmouseover="this.style.backgroundColor='#6518d8'"
        onmouseout="this.style.backgroundColor='#7A1CFF'">
        Delete
      </button>
    } @else {
      <p class="text-gray-400 italic">Select a comment to view details</p>
    }
  </div>
</div>
</div>

<ng-template #noAccess>
  <div class="text-center text-red-500 font-bold">
    Access Denied
  </div>
</ng-template>
